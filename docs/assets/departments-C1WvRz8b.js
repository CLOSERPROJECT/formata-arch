import{g as f,R as s,p as m,s as c,c as g,a as u,r as h,b as l,d as w,f as D,e as x}from"./index-C1tYyTHg.js";import{C as v}from"./form.svelte-DCZ7BqoX.js";import{N as E}from"./new-button-Cp-j6Coz.js";class b{constructor(t){this.config=t}getEntityName(){return"Department"}getKey(t){return t.id}getSchema(){return f("Department")}list(){return this.config.departments}getOne(t){const r=this.config.departments.find(i=>i.id===t);return r!==void 0?s.ok(r):s.err(new Error(`Department not found: ${t}`))}create(t){return this.config.departments.some(r=>r.id===t.id)?s.err(new Error(`Department already exists: ${t.id}`)):(this.config.departments=[...this.config.departments,t],s.ok(t))}update(t,r){if(this.config.departments.findIndex(e=>e.id===t)===-1)return s.err(new Error(`Department not found: ${t}`));const n=r.id;if(t!==n){if(this.config.departments.some(e=>e.id===n))return s.err(new Error(`Department already exists: ${n}`));this.config.users=this.config.users.map(e=>e.departmentId===t?{...e,departmentId:n}:e),this.config.workflow={...this.config.workflow,steps:this.config.workflow.steps.map(e=>({...e,substeps:e.substeps.map(o=>o.role===t?{...o,role:n}:o)}))}}return this.config.departments=this.config.departments.map(e=>e.id===t?r:e),s.ok(r)}delete(t){return this.config.departments.findIndex(i=>i.id===t)===-1?s.err(new Error(`Department not found: ${t}`)):(this.config.departments=this.config.departments.filter(i=>i.id!==t),s.ok(void 0))}}var I=D('<div class="p-4"><!></div>');function N(d,t){m(t,!0);const r=a=>{E(a,{onClick:()=>n.openCreate()})},i=new b(x),n=new v(i);c({title:"Departments",right:r});var e=I(),o=g(e);u(o,()=>n.Table,(a,p)=>{p(a,{get self(){return n}})}),h(e),l(d,e),w()}export{N as default};
